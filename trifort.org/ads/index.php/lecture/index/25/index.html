<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>cse674 - advanced data strucures</title>
  <link href="../../../../../css/styles.css" rel="stylesheet" type="text/css"></link>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
  <link rel="shortcut icon" href="http://trifort.org/cse382/img/favicon2.ico" />
  </head>
  <body>
    <div class="page_block1">
      <div class="page_block2">

        <div class="section">
          <h1>25: parallel algorithms #2</h1>
          Batcher's Even-Odd Sort | Parallel Merge | Sorting Networks | Counting Networks<br />
          Parallel Prefix Sum | Stream Compaction | Peer-to-Peer Overlay | DHT | p2pstm<br />
        </div>

        <div class="section">
          <h2>Batchers Even-Odd Sort [1]</h2>
            Batchers even-odd sort is based on compare_exchange operations. Algorithms like this are non-adaptive algorithms and can be written as a "straight-line" sequence of instructions.<br />
          <br />
          Bubble sort of 3 numbers using only compare exchange:
          <div class="code_block"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_comment">// bubbleCompareExchange.cpp - download <a href="../../../dlcode/index/bubbleCompareExchange.cpp.html">here</a></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">vector&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">iostream&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">compare_exchange(</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">vector&lt;</div><div class="code_green">int</div><div class="code_nothing">&gt;</div><div class="code_nothing">&</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">index1,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">index2)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">lhs&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">index1]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">rhs&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">index2]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">rhs&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">lhs)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">index1]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">rhs;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">index2]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">lhs;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">15:&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">bubble3(</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">vector&lt;</div><div class="code_green">int</div><div class="code_nothing">&gt;</div><div class="code_nothing">&</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">16:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">compare_exchange(</div><div class="code_nothing">vec,&nbsp;</div><div class="code_nothing">0,&nbsp;</div><div class="code_nothing">1)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">17:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">compare_exchange(</div><div class="code_nothing">vec,&nbsp;</div><div class="code_nothing">0,&nbsp;</div><div class="code_nothing">2)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">18:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">compare_exchange(</div><div class="code_nothing">vec,&nbsp;</div><div class="code_nothing">1,&nbsp;</div><div class="code_nothing">2)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">19:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">20:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">21:&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">main(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">argc,&nbsp;</div><div class="code_green">char</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">argv[</div><div class="code_nothing">]</div><div class="code_nothing">)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">22:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">23:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">vector&lt;</div><div class="code_green">int</div><div class="code_nothing">&gt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">to_sort;</div><div class="code_nothing"></div><br /><div class="code_grey">24:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">to_sort.push_back(</div><div class="code_nothing">3)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">25:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">to_sort.push_back(</div><div class="code_nothing">2)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">26:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">to_sort.push_back(</div><div class="code_nothing">1)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">27:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">28:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">bubble3(</div><div class="code_nothing">to_sort)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">29:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">30:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">size_t</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">to_sort.size(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">31:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">to_sort[</div><div class="code_nothing">i]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">32:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">33:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">34:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//prints:</div><br /><div class="code_grey">35:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;1</div><br /><div class="code_grey">36:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;2</div><br /><div class="code_grey">37:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;3</div><br /><div class="code_grey">38:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">39:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">return</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing"></div><br /><div class="code_grey">40:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /></div>
          In this version of batchers even-odd sort, the number of processors we have is N / 2.<br />
          This is a parallel comparison sort that takes O(n) time (assuming you have N/2 processors).
          <div class="code_block"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_comment">// gpuBatchers.cpp - download <a href="../../../dlcode/index/gpuBatchers.cpp.html">here</a></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">vector&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">iostream&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">compare_exchange(</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">vector&lt;</div><div class="code_green">int</div><div class="code_nothing">&gt;</div><div class="code_nothing">&</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">left,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">right)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">lhs&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">left]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">rhs&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">right]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">rhs&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">lhs)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">left]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">rhs;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">right]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">lhs;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">15:&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">batchersEvenOdd(</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">vector&lt;</div><div class="code_green">int</div><div class="code_nothing">&gt;</div><div class="code_nothing">&</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">procs)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">16:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">num&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec.size(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">17:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">num;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">18:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">proc&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">proc&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">procs;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++proc)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">19:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">left;</div><div class="code_nothing"></div><br /><div class="code_grey">20:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">right;</div><div class="code_nothing"></div><br /><div class="code_grey">21:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">%&nbsp;</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">22:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">left&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">proc;</div><div class="code_nothing"></div><br /><div class="code_grey">23:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">right&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">(</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">proc)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">+&nbsp;</div><div class="code_nothing">1;</div><div class="code_nothing"></div><br /><div class="code_grey">24:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing">&nbsp;</div><div class="code_red">else</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">25:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">left&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">(</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">proc)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">+&nbsp;</div><div class="code_nothing">1;</div><div class="code_nothing"></div><br /><div class="code_grey">26:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">right&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">(</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">proc)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">+&nbsp;</div><div class="code_nothing">2;</div><div class="code_nothing"></div><br /><div class="code_grey">27:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">28:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">right&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">num)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">29:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">compare_exchange(</div><div class="code_nothing">vec,&nbsp;</div><div class="code_nothing">left,&nbsp;</div><div class="code_nothing">right)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">30:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">31:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">32:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">33:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">34:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">35:&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">main(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">argc,&nbsp;</div><div class="code_green">char</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">argv[</div><div class="code_nothing">]</div><div class="code_nothing">)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">36:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">37:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">vector&lt;</div><div class="code_green">int</div><div class="code_nothing">&gt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec;</div><div class="code_nothing"></div><br /><div class="code_grey">38:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">size&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">8;</div><div class="code_nothing"></div><br /><div class="code_grey">39:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">size-1;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&gt;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">--i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">40:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec.push_back(</div><div class="code_nothing">i)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">41:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">42:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">43:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_string">"values:&nbsp;"</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">44:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">size_t</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec.size(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">45:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">i]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_string">"&nbsp;"</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">46:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">47:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">48:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">49:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">batchersEvenOdd(</div><div class="code_nothing">vec,&nbsp;</div><div class="code_nothing">size&nbsp;</div><div class="code_nothing">/&nbsp;</div><div class="code_nothing">2)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">50:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">51:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_string">"values:&nbsp;"</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">52:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">size_t</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec.size(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">53:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">i]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_string">"&nbsp;"</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">54:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">55:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">56:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">57:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//prints:</div><br /><div class="code_grey">58:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;values:&nbsp;</div><br /><div class="code_grey">59:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;7&nbsp;6&nbsp;5&nbsp;4&nbsp;3&nbsp;2&nbsp;1&nbsp;0&nbsp;</div><br /><div class="code_grey">60:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;values:&nbsp;</div><br /><div class="code_grey">61:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;0&nbsp;1&nbsp;2&nbsp;3&nbsp;4&nbsp;5&nbsp;6&nbsp;7&nbsp;</div><br /><div class="code_grey">62:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">63:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">return</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing"></div><br /><div class="code_grey">64:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /></div>

          <div class="sort_view_container" style="width: 400px;">
          <div class="sort_view_item">12</div>
          <div class="sort_view_item">10</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">11</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">14</div>
          <div class="sort_view_item" style="background-color: #ff9900;">13</div>
          <div class="sort_view_item" style="background-color: #ff9900;">20</div>
          <div class="sort_view_item" style="background-color: #ff6600;">17</div>
          <div class="sort_view_item" style="background-color: #ff6600;">16</div>
          </div>

          <br />
          <br />
          <br />
          <br />

          <div class="sort_view_container" style="width: 400px;">
          <div class="sort_view_item">10</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">12</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">11</div>
          <div class="sort_view_item" style="background-color: #ff6600;">14</div>
          <div class="sort_view_item" style="background-color: #ff6600;">13</div>
          <div class="sort_view_item" style="background-color: #ff9900;">20</div>
          <div class="sort_view_item" style="background-color: #ff9900;">16</div>
          <div class="sort_view_item">17</div>
          </div>

          <br />
          <br />
          <br />
          <br />

          <div class="sort_view_container" style="width: 400px;">
          <div class="sort_view_item">10</div>
          <div class="sort_view_item">11</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">12</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">13</div>
          <div class="sort_view_item" style="background-color: #ff9900;">14</div>
          <div class="sort_view_item" style="background-color: #ff9900;">16</div>
          <div class="sort_view_item" style="background-color: #ff6600;">20</div>
          <div class="sort_view_item" style="background-color: #ff6600;">17</div>
          </div>

          <br />
          <br />
          <br />
          <br />

          <div class="sort_view_container" style="width: 400px;">
          <div class="sort_view_item">10</div>
          <div class="sort_view_item">11</div>
          <div class="sort_view_item">12</div>
          <div class="sort_view_item">13</div>
          <div class="sort_view_item">14</div>
          <div class="sort_view_item">16</div>
          <div class="sort_view_item">17</div>
          <div class="sort_view_item">20</div>
          </div>

          <br />
          <br />
          <br />
          <br />

        </div>

        <div class="section">
          <h2>Parallel Merge</h2>
            Due to practical reasons, a Batchers Even-Odd Sort cannot be done on an entire large array sometimes and an efficient parallel merge is needed.<br />
          <br />
            Each of the P processors can view the entire array. The array is segmented into P sorted sections. In parallel, each processor computes the rank of all of its elements. After, on one core, all the elements are placed into their final position.<br />
          <br />
            Example of ranks computed by 4 processors:<br />
          <br />

          <div class="sort_view_container" style="width: 700px;">
          <div class="sort_view_item" style="width: 100px;">value</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">10</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">11</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">15</div>
          <div class="sort_view_item" style="background-color: #ff9900;">6</div>
          <div class="sort_view_item" style="background-color: #ff9900;">8</div>
          <div class="sort_view_item" style="background-color: #ff9900;">12</div>
          <div class="sort_view_item" style="background-color: #ff6600;">20</div>
          <div class="sort_view_item" style="background-color: #ff6600;">23</div>
          <div class="sort_view_item" style="background-color: #ff6600;">50</div>
          <div class="sort_view_item" style="background-color: #ff3300;">9</div>
          <div class="sort_view_item" style="background-color: #ff3300;">16</div>
          <div class="sort_view_item" style="background-color: #ff3300;">90</div><br />

          <div class="sort_view_item" style="width: 100px;">rank</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">6</div>
          <div class="sort_view_item" style="background-color: #ff9900;">0</div>
          <div class="sort_view_item" style="background-color: #ff9900;">2</div>
          <div class="sort_view_item" style="background-color: #ff9900;">5</div>
          <div class="sort_view_item" style="background-color: #ff6600;">8</div>
          <div class="sort_view_item" style="background-color: #ff6600;">9</div>
          <div class="sort_view_item" style="background-color: #ff6600;">10</div>
          <div class="sort_view_item" style="background-color: #ff3300;">1</div>
          <div class="sort_view_item" style="background-color: #ff3300;">7</div>
          <div class="sort_view_item" style="background-color: #ff3300;">11</div><br />
          </div>

          <br><br>
          <br><br>
          <br><br>

          Algorithm:
          <div class="algorithm"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_red">algorithm</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">computeRank(</div><div class="code_nothing">vector&nbsp;</div><div class="code_nothing">vec,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">left,&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">right)</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vector&nbsp;</div><div class="code_nothing">ret;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">size&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">right&nbsp;</div><div class="code_nothing">-&nbsp;</div><div class="code_nothing">left</div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">left&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">right</div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">rank&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">i;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">key&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">i]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">offset&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">size&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">vec.size(</div><div class="code_nothing">)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">increment&nbsp;</div><div class="code_nothing">by&nbsp;</div><div class="code_nothing">size&nbsp;</div><div class="code_nothing">then&nbsp;</div><div class="code_nothing">wrap&nbsp;</div><div class="code_nothing">around&nbsp;</div><div class="code_nothing">until&nbsp;</div><div class="code_nothing">left&nbsp;</div><div class="code_nothing">is&nbsp;</div><div class="code_nothing">hit</div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">j&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">size</div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">vec[</div><div class="code_nothing">offset+j]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">key</div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++rank;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">else</div><div class="code_nothing">&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">break</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">out&nbsp;</div><div class="code_nothing">of&nbsp;</div><div class="code_nothing">j&nbsp;</div><div class="code_nothing">loop</div><br /></div>

        </div>

        <div class="section">
          <h2>Sorting Network [1]</h2>
            A simple sorting network has comparaters at each vertice line. Two inputs come into 
            the left and the smaller is output on top and the larger is output on bottom.<br />
            <img src="../../../../img/pict/SortingNetwork_0.bmp" alt="SortingNetwork" /><br />
            Larger sorting network (Batcher's even-odd merging network)<br />
            <img src="../../../../img/pict/SortingNetwork_1.bmp" alt="SortingNetwork" /><br />
        </div>

        <div class="section">
          <h2>Block Merge with Sorting Network [1]</h2>
            Each merge node merges the block and then puts the smaller values half on the top and the larger values half on the bottom.<br />
            <img src="../../../../img/pict/MergingNetwork_0.bmp" alt="MergingNetwork" /><br />
        </div>

        <div class="section">
          <h2>Counting Network [5]</h2>
          In counting networks, a process puts a value on any wire and the value is propegated through the network. Each balancer alternates the output wire that the
          value will go to. This is useful for low contention counting inside hardware. In this figure each balancer starts in the up position.<br />
          <img src="../../../../img/pict/CountingNetwork_0.bmp" alt="CountingNetwork" /><br />
          This counting network is very similar to a work distribution scheme using queues.<br />
          <br />
        </div>

        <div class="section">
          <h2>Parallel Prefix Sum [6,7]</h2>
          Prefix sum calculates the sum of all elements before an element in the array, plus itself.<br />
          <img src="../../../../img/prefix_sum.png" alt="PrefixSum" /><br />
          (Image from wikipedia [6])<br />
          <br />

          <div class="sort_view_container" style="width: 700px;">
          <div class="sort_view_item" style="width: 100px;">value</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">6</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">10</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">12</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">9</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div><br />

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">6</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">11</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">15</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">18</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">28</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">40</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">41</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">44</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">53</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">60</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">67</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">75</div><br />
          </div>

          <br><br>
          <br><br>
          <br><br>

          Prefix sum can be used in a version of counting sort that is stable with
          key/value pairs.<br />
          <div class="algorithm"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_red">algorithm</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">prefixSumCountingSort(</div><div class="code_nothing">array&nbsp;</div><div class="code_nothing">a)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">k&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">max_value(</div><div class="code_nothing">a)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array&nbsp;</div><div class="code_nothing">b&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_red">new</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array[</div><div class="code_nothing">a.length]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array&nbsp;</div><div class="code_nothing">c&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_red">new</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array[</div><div class="code_nothing">k]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">k;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">c[</div><div class="code_nothing">i]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">a.length;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">c[</div><div class="code_nothing">a[</div><div class="code_nothing">i]</div><div class="code_nothing">]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">+=&nbsp;</div><div class="code_nothing">1;</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">c&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">calculate_prefix_sum(</div><div class="code_nothing">c)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">a.length&nbsp;</div><div class="code_nothing">-&nbsp;</div><div class="code_nothing">1;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&gt;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">--i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">b[</div><div class="code_nothing">c[</div><div class="code_nothing">a[</div><div class="code_nothing">i]</div><div class="code_nothing">]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">-&nbsp;</div><div class="code_nothing">1]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">a[</div><div class="code_nothing">i]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">c[</div><div class="code_nothing">a[</div><div class="code_nothing">i]</div><div class="code_nothing">]</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">-=&nbsp;</div><div class="code_nothing">1;</div><div class="code_nothing"></div><br /><div class="code_grey">15:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing">&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">16:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /></div>

          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">orig array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>

          <div class="sort_view_item" style="width: 100px;">counts</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>

          <br><br>
          <br><br>
          <br><br>
          <br />

          <ol>
            <li>Start:<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-1] = 3. c[3] - 1 = 6. --c[3] = 6.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">6</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-2] = 0. c[0] - 1 = 1. --c[0] = 1.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">6</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-3] = 3. c[3] - 1 = 5. --c[3] = 5.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-4] = 2. c[2] - 1 = 3. --c[2] = 3.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-5] = 0. c[0] - 1 = 0. --c[2] = 0.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-6] = 3. c[3] - 1 = 4. --c[2] = 4.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">8</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-7] = 5. c[5] - 1 = 7. --c[2] = 7.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
            <li>a[length-7] = 2. c[2] - 1 = 2. --c[2] = 2.<br /><br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">out array</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">5</div>

          <div class="sort_view_item" style="width: 100px;">prefix sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">4</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">7</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          <div class="sort_view_item_spacer">&nbsp;</div>
          </div>
          <br><br>
          <br><br>
          <br><br>
            </li>
          </ol>

          <ul>
            <li>Prefix sum time complexity: 2*lgn or O(lgn)</li>
            <li>Stable Serial Counting Sort time complexity: 2*k + 2*n = O(k+n)</li>
            <li>Stable Parallel Counting Sort time complexity: k + 2*lgk + 2*n = O(k+n)</li>
            <li>The parallel version can have a faster wall clock time assuming k/2 processors, minimal communication time and equal cache effects</li>
          </ul>

          Also note that a stable counting sort can be used as a sorting function in radix sort.
          <div class="algorithm"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_red">struct</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">SortPair&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">digit;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array_element;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_red">algorithm</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">countingRadixSort(</div><div class="code_nothing">array&nbsp;</div><div class="code_nothing">a)</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">d&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">max_digits_in_any_element(</div><div class="code_nothing">a)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array&nbsp;</div><div class="code_nothing">sort_pairs&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_red">new</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">array[</div><div class="code_nothing">a.length]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_nothing">j&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">j&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">a.length;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++j)</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">sort_pairs[</div><div class="code_nothing">j]</div><div class="code_nothing">.array_element&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">a[</div><div class="code_nothing">j]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">d;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_nothing">j&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">j&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">sort_pairs.length;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++j)</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">sort_pairs[</div><div class="code_nothing">j]</div><div class="code_nothing">.digit&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">extract_digit(</div><div class="code_nothing">i,&nbsp;</div><div class="code_nothing">sort_pairs[</div><div class="code_nothing">j]</div><div class="code_nothing">.array_element)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">use&nbsp;</div><div class="code_nothing">counting&nbsp;</div><div class="code_nothing">sort&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">order&nbsp;</div><div class="code_nothing">sort_pairs&nbsp;</div><div class="code_nothing">based&nbsp;</div><div class="code_nothing">on&nbsp;</div><div class="code_nothing">digit&nbsp;</div><div class="code_nothing">(</div><div class="code_nothing">ranges&nbsp;</div><div class="code_nothing">0-9)</div><div class="code_nothing">;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing"></div><br /></div>

        </div>

        <div class="section">
          <h2>Parallel Prefix Sum Stream Compaction [8]</h2>
          In parallel on a graphics card, some objects need to be processed, some need to be skipped.<br />
          <br />
          <div class="sort_view_container" style="width: 500px;">
          <div class="sort_view_item" style="width: 100px;">Stream</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">A</div>
          <div class="sort_view_item" style="background-color: #ffffff;">B</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">C</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">D</div>
          <div class="sort_view_item" style="background-color: #ffffff;">E</div>
          <div class="sort_view_item" style="background-color: #ffffff;">F</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">G</div>
          <div class="sort_view_item" style="background-color: #ffffff;">H</div>

          <div class="sort_view_item" style="width: 100px;">Keep Nodes</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffffff;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffffff;">0</div>
          <div class="sort_view_item" style="background-color: #ffffff;">0</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffffff;">0</div>

          <div class="sort_view_item" style="width: 100px;">Prefix Sum</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">0</div>
          <div class="sort_view_item" style="background-color: #ffffff;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">1</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">2</div>
          <div class="sort_view_item" style="background-color: #ffffff;">3</div>
          <div class="sort_view_item" style="background-color: #ffffff;">3</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">3</div>
          <div class="sort_view_item" style="background-color: #ffffff;">4</div>

          <div class="sort_view_item" style="width: 100px;">Result</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">A</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">C</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">D</div>
          <div class="sort_view_item" style="background-color: #ffcc00;">G</div>
          </div>

          <br /><br />
          <br /><br />
          <br /><br />
          <br /><br />
          <br /><br />

        </div>

        <div class="section">
          <h2>Peer-to-Peer Network Overlay</h2>
          The napster music sharing service created a new research topic in computer science: Fully decentralized, fault tolerant, scalable networking. Napster itself used centralized servers to index what songs where on what computers.<br />
          <br />
          Peer-to-Peer Network Overlays were created in academia to solve the indexing problems napster had.<br />
          <br />
          Today BitTorrent [2], the Storm Botnet [2] and Skype are based on advances in peer-to-peer network overlays.<br />
          <br />
          FreePastry is one of the peer-to-peer network overlays from academia:<br />
          <br />
          <div style="width: 400px; text-align: center; margin-left: auto; margin-right: auto;">
          <img src="../../../../img/p2p_ring.png" alt="p2p_ring" /><br />
          (Image from [4])
          </div>
          <br />
          A node joins the ring by contacting a node in the ring by IP address. A routing table is kept at each node. At each hop in a message being routed, it goes to a node that has at least one digit in the node-id closer.<br />
          <br />
          Messages are guarenteed to be routed in O(lgn) hops.
          </div>
          <div class="section">
          <h2>Distributed Hash Table</h2>
          A distributed hash table is a hash table that uses a peer-to-peer network overlay. To store a file, a hash of the filename is produced. The file is then sent to the closest node-id of that hash.
          <ul>
            <li>The file is replicated on k nearest nodes.</li>
            <li>If the primary computer that the file is stored on exits the network, next time the file is requested, the message will go to the now closest node. Since the file was replicated, the new closest node also has the exact file.</li>
            <li>When a new closest node notices that serves a file, it can again replicate the file to k nearest nodes.</li>
            <li>Once a file is in the system, it can never be changed due to concurrency issues.</li>
          </ul>
        </div>

        <div class="section">
          <h2>p2pstm [3]</h2>
          p2pstm solves the problem of a distributed hash table where you can only write data. It provides a software transactional memory concurrency control abstraction rather than a locked based abstraction.
          <h3>Lock Based Concurrency Control</h3>
          Our bank account concurrency problems from the previous lecture can be solved with locks:
          <div class="code_block"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_comment">// bankAccountLocks.cpp - download <a href="../../../dlcode/index/bankAccountLocks.cpp.html">here</a></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">iostream&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">pthread.h&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">unistd.h&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_preproc">#include</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">cstdlib&gt;</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_red">class</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_red">public</div><div class="code_nothing">:</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account(</div><div class="code_green">bool</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">use_locking)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">~Account(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">getBalance(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">setBalance(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">value)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">acquireLock(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">15:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">releaseLock(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">16:&nbsp;</div><div class="code_red">private</div><div class="code_nothing">:</div><div class="code_nothing"></div><br /><div class="code_grey">17:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">m_Balance;</div><div class="code_nothing"></div><br /><div class="code_grey">18:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_mutex_t&nbsp;</div><div class="code_nothing">m_Mutex;</div><div class="code_nothing"></div><br /><div class="code_grey">19:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">bool</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">m_UseLocking;</div><div class="code_nothing"></div><br /><div class="code_grey">20:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">21:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">22:&nbsp;</div><div class="code_nothing">Account:</div><div class="code_nothing">:</div><div class="code_nothing">Account(</div><div class="code_green">bool</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">use_locking)</div><div class="code_nothing"></div><br /><div class="code_grey">23:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">:</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">m_Balance(</div><div class="code_nothing">0)</div><div class="code_nothing">,&nbsp;</div><div class="code_nothing">m_UseLocking(</div><div class="code_nothing">use_locking)</div><div class="code_nothing"></div><br /><div class="code_grey">24:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">25:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_mutex_init(</div><div class="code_nothing">&</div><div class="code_nothing">m_Mutex,&nbsp;</div><div class="code_nothing">NULL)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">26:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">27:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">28:&nbsp;</div><div class="code_nothing">Account:</div><div class="code_nothing">:</div><div class="code_nothing">~Account(</div><div class="code_nothing">)</div><div class="code_nothing"></div><br /><div class="code_grey">29:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">30:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_mutex_destroy(</div><div class="code_nothing">&</div><div class="code_nothing">m_Mutex)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">31:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">32:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">33:&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account:</div><div class="code_nothing">:</div><div class="code_nothing">getBalance(</div><div class="code_nothing">)</div><div class="code_nothing"></div><br /><div class="code_grey">34:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">35:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">return</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">m_Balance;</div><div class="code_nothing"></div><br /><div class="code_grey">36:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">37:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">38:&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account:</div><div class="code_nothing">:</div><div class="code_nothing">setBalance(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">value)</div><div class="code_nothing"></div><br /><div class="code_grey">39:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">40:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">m_Balance&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">value;</div><div class="code_nothing"></div><br /><div class="code_grey">41:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">42:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">43:&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account:</div><div class="code_nothing">:</div><div class="code_nothing">acquireLock(</div><div class="code_nothing">)</div><div class="code_nothing"></div><br /><div class="code_grey">44:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">45:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">m_UseLocking)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">46:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_mutex_lock(</div><div class="code_nothing">&</div><div class="code_nothing">m_Mutex)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">47:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">48:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">49:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">50:&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account:</div><div class="code_nothing">:</div><div class="code_nothing">releaseLock(</div><div class="code_nothing">)</div><div class="code_nothing"></div><br /><div class="code_grey">51:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">52:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">m_UseLocking)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">53:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_mutex_unlock(</div><div class="code_nothing">&</div><div class="code_nothing">m_Mutex)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">54:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">55:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">56:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">57:&nbsp;</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">threadProc(</div><div class="code_green">void</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">data)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">58:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">59:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">account&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">(</div><div class="code_nothing">Account&nbsp;</div><div class="code_nothing">*)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">data;</div><div class="code_nothing"></div><br /><div class="code_grey">60:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">100000;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">61:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account-&gt;</div><div class="code_nothing">acquireLock(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">62:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">bal&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account-&gt;</div><div class="code_nothing">getBalance(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">63:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">bal&nbsp;</div><div class="code_nothing">+=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">20;</div><div class="code_nothing"></div><br /><div class="code_grey">64:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account-&gt;</div><div class="code_nothing">setBalance(</div><div class="code_nothing">bal)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">65:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account-&gt;</div><div class="code_nothing">releaseLock(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">66:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">67:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">68:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">69:&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">main(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">argc,&nbsp;</div><div class="code_green">char</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">*&nbsp;</div><div class="code_nothing">argv[</div><div class="code_nothing">]</div><div class="code_nothing">)</div><div class="code_nothing"></div><br /><div class="code_grey">70:&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">71:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">72:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">const</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">num_threads&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">2;</div><div class="code_nothing"></div><br /><div class="code_grey">73:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_t&nbsp;</div><div class="code_nothing">threads1[</div><div class="code_nothing">num_threads]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">74:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_t&nbsp;</div><div class="code_nothing">threads2[</div><div class="code_nothing">num_threads]</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">75:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account&nbsp;</div><div class="code_nothing">account1(</div><div class="code_nothing">true)</div><div class="code_nothing">;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">76:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">Account&nbsp;</div><div class="code_nothing">account2(</div><div class="code_nothing">false)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">77:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">78:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">num_threads;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">79:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_create(</div><div class="code_nothing">&</div><div class="code_nothing">threads1[</div><div class="code_nothing">i]</div><div class="code_nothing">,&nbsp;</div><div class="code_nothing">NULL,&nbsp;</div><div class="code_nothing">&</div><div class="code_nothing">threadProc,&nbsp;</div><div class="code_nothing">&</div><div class="code_nothing">account1)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">80:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_create(</div><div class="code_nothing">&</div><div class="code_nothing">threads2[</div><div class="code_nothing">i]</div><div class="code_nothing">,&nbsp;</div><div class="code_nothing">NULL,&nbsp;</div><div class="code_nothing">&</div><div class="code_nothing">threadProc,&nbsp;</div><div class="code_nothing">&</div><div class="code_nothing">account2)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">81:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">82:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">83:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">for</div><div class="code_nothing">(</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">=</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">i&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">num_threads;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">++i)</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">84:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_join(</div><div class="code_nothing">threads1[</div><div class="code_nothing">i]</div><div class="code_nothing">,&nbsp;</div><div class="code_nothing">NULL)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">85:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">pthread_join(</div><div class="code_nothing">threads2[</div><div class="code_nothing">i]</div><div class="code_nothing">,&nbsp;</div><div class="code_nothing">NULL)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">86:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">87:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">88:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_string">"locked&nbsp;final&nbsp;balance:&nbsp;"</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account1.getBalance(</div><div class="code_nothing">)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">89:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">cout&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_string">"unlocked&nbsp;final&nbsp;balance:&nbsp;"</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account2.getBalance(</div><div class="code_nothing">)</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&lt;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">std:</div><div class="code_nothing">:</div><div class="code_nothing">endl;</div><div class="code_nothing"></div><br /><div class="code_grey">90:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//prints:</div><br /><div class="code_grey">91:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;locked&nbsp;final&nbsp;balance:&nbsp;4000000</div><br /><div class="code_grey">92:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_comment">//&nbsp;&nbsp;unlocked&nbsp;final&nbsp;balance:&nbsp;2583880</div><br /><div class="code_grey">93:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">94:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">return</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">0;</div><div class="code_nothing"></div><br /><div class="code_grey">95:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /></div>

          <h3>Software Transactional Memory Concurrency Control</h3>
          In STM, no locks are used. For each variable, a version number is kept and the idea of a transaction is used.
          <div class="algorithm"><div class="code_grey">1:&nbsp;</div><div class="code_red">algorithm</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">updateBalanceThreadProc(</div><div class="code_nothing">account)</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">atomic</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_green">int</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">bal&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">account.getBalance(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">bal&nbsp;</div><div class="code_nothing">+=&nbsp;</div><div class="code_nothing">20;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">account.setBalance(</div><div class="code_nothing">bal)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /></div>

          <h3>p2pstm algorithm</h3>
          Each variable in the program is represented by a (keyword:version) pair. The distributed memory addresses are computed by transforming the (keyword:version) 2-dimensional pair into a 1-dimensional node-id using Hilbert Space Filling Curves.<br />
          <div style="width: 400px; text-align: center; margin-left: auto; margin-right: auto;">
            <img src="../../../../img/p2p_hilbert.png" alt="p2p_hilbert" />
          </div>
          Then the following algorithm is used. The reads and writes to the distributed memory are done in a sorted order of the (keyword:version) pair to prevent deadlocks.
          <div class="algorithm"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_red">algorithm</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">p2pstmCommit(</div><div class="code_nothing">transaction)</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">while</div><div class="code_nothing">(</div><div class="code_nothing">not&nbsp;</div><div class="code_nothing">committed)</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">read&nbsp;</div><div class="code_nothing">all&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">variables&nbsp;</div><div class="code_nothing">and&nbsp;</div><div class="code_nothing">versions&nbsp;</div><div class="code_nothing">in&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">transaction;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">executed&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">transaction&nbsp;</div><div class="code_nothing">on&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">variables;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">read&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">versions&nbsp;</div><div class="code_nothing">again;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">write&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">variables&nbsp;</div><div class="code_nothing">and&nbsp;</div><div class="code_nothing">versions&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">distributed&nbsp;</div><div class="code_nothing">memory;</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">any&nbsp;</div><div class="code_nothing">write&nbsp;</div><div class="code_nothing">failed)</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">restart&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">transaction;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">send&nbsp;</div><div class="code_nothing">validations&nbsp;</div><div class="code_red">for</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">each&nbsp;</div><div class="code_nothing">variable&nbsp;</div><div class="code_nothing">and&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">distributed&nbsp;</div><div class="code_nothing">memory;</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_red">if</div><div class="code_nothing">(</div><div class="code_nothing">and&nbsp;</div><div class="code_nothing">validation&nbsp;</div><div class="code_nothing">failed)</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">restart&nbsp;</div><div class="code_nothing">the&nbsp;</div><div class="code_nothing">transaction;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing"></div><br /></div>

          <b>Example</b><br />
          <div class="algorithm"><div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_nothing">Client&nbsp;</div><div class="code_nothing">Node&nbsp;</div><div class="code_nothing">1:</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_red">atomic</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">transaction:</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">add&nbsp;</div><div class="code_nothing">name1&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">authors;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">add&nbsp;</div><div class="code_nothing">book_uuid1&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">books;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">add&nbsp;</div><div class="code_nothing">book_uuid1&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">compsci_books;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">Client&nbsp;</div><div class="code_nothing">Node&nbsp;</div><div class="code_nothing">2:</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_red">atomic</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">transaction:</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">{</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">add&nbsp;</div><div class="code_nothing">name2&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">authors;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">add&nbsp;</div><div class="code_nothing">book_uuid2&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">books;</div><div class="code_nothing"></div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">add&nbsp;</div><div class="code_nothing">book_uuid2&nbsp;</div><div class="code_nothing">to&nbsp;</div><div class="code_nothing">compsci_books;</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">}</div><div class="code_nothing"></div><br /></div>

          <b>Operations</b><br />
          <table>
            <tr>
              <td style="padding: 5px; width: 400px;">
                <div class="algorithm" style="width: 300px;">
                <div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">t1.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">t1.validate(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">t1.validate(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">t1.validate(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br />                </div>
              </td>
              <td style="padding: 5px; width: 400px;">
                <div class="algorithm" style="width: 300px;">
                <div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">t2.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">t2.validate(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">t2.validate(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">t2.validate(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br />                </div>
              </td>
            </tr>
          </table>
          <br />
          <b>Execution Possibility #1</b>
          <div class="algorithm">
          <div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">15:&nbsp;</div><div class="code_nothing">t1.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">16:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">17:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">18:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">19:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">20:&nbsp;</div><div class="code_nothing">t2.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">21:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">22:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">23:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">24:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">25:&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">26:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">27:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">28:&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">29:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">failure.&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">already&nbsp;</div><div class="code_nothing">reseverd</div><br /><div class="code_grey">30:&nbsp;</div><div class="code_nothing">t2.restart_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">31:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">32:&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">33:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">34:&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">35:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">36:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">37:&nbsp;</div><div class="code_nothing">t1.validate(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">38:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">final&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">39:&nbsp;</div><div class="code_nothing">t1.validate(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">40:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">final&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">41:&nbsp;</div><div class="code_nothing">t1.validate(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">42:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">final&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br />          </div>
          <b>Execution Possibility #2</b>
          <div class="algorithm">
          <div class="code_grey">1:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">2:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">3:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">4:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">5:&nbsp;&nbsp;</div><div class="code_nothing">t1.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">6:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">7:&nbsp;&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">8:&nbsp;&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">9:&nbsp;&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">10:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">11:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">12:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">13:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">14:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">elec_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">15:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">elec_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">16:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">17:&nbsp;</div><div class="code_nothing">t1.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">18:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">19:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">20:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">21:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">22:&nbsp;</div><div class="code_nothing">t2.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">23:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">24:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">25:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">26:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">27:&nbsp;</div><div class="code_nothing">t1.write(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">28:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">29:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">30:&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">31:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">failure.&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">2&nbsp;</div><div class="code_nothing">already&nbsp;</div><div class="code_nothing">reseverd</div><br /><div class="code_grey">32:&nbsp;</div><div class="code_nothing">t2.restart_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">33:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">34:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">35:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">36:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">37:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">38:&nbsp;</div><div class="code_nothing">t2.read(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">39:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">1</div><br /><div class="code_grey">40:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">41:&nbsp;</div><div class="code_nothing">t2.exec_transaction(</div><div class="code_nothing">)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">42:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">3</div><br /><div class="code_grey">43:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">44:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">local&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">45:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">46:&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">authors)</div><div class="code_nothing"></div><br /><div class="code_grey">47:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">3</div><br /><div class="code_grey">48:&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">49:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">50:&nbsp;</div><div class="code_nothing">t2.write(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">51:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">reserved&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">compsci_books&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">52:&nbsp;</div><div class="code_nothing"></div><br /><div class="code_grey">53:&nbsp;</div><div class="code_nothing">t2.validate(</div><div class="code_nothing">authors)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">54:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">final&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">3</div><br /><div class="code_grey">55:&nbsp;</div><div class="code_nothing">t2.validate(</div><div class="code_nothing">books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">56:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">final&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br /><div class="code_grey">57:&nbsp;</div><div class="code_nothing">t2.validate(</div><div class="code_nothing">compsci_books)</div><div class="code_nothing">;</div><div class="code_nothing"></div><br /><div class="code_grey">58:&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">&nbsp;</div><div class="code_nothing">success.&nbsp;</div><div class="code_nothing">final&nbsp;</div><div class="code_nothing">remote&nbsp;</div><div class="code_nothing">authors&nbsp;</div><div class="code_nothing">version&nbsp;</div><div class="code_nothing">=&nbsp;</div><div class="code_nothing">2</div><br />          </div>
          <br />
          There are more execution possibilities, but the partial ordering of (keyword,version) pairs guarentees there are no deadlocks in all cases.
        </div>
        <div class="section">
          <h2>References</h2>
          <ol>
            <li>Robert Sedgewick, Algorithms in C++ Parts 1-4, pages 453 to 483</li>
            <li>http://en.wikipedia.org/wiki/Distributed_hash_table</li>
            <li>Pratt-Szeliga, Phil and Fawcett, Jim, "p2pstm: A Peer-to-Peer Software Transactional Memory" (2010). Electrical Engineering and
          Computer Science. Paper 170.
          http://surface.syr.edu/eecs/170</li>
            <li>A. Rowstron and P. Druschel, "Pastry: Scalable, distributed object location and routing for large-scale peer-to-peer systems".  IFIP/ACM International Conference on Distributed Systems Platforms (Middleware), Heidelberg, Germany, pages 329-350, November, 2001.</li>
            <li>http://www.cs.yale.edu/homes/aspnes/papers/ahs.pdf</li>
            <li>http://en.wikipedia.org/wiki/Prefix_sum</li>
            <li>Cormen, Thomas H.; Leiserson, Charles E.; Rivest, Ronald L.; Stein, Clifford (2001), "8.2 Counting Sort", Introduction to Algorithms (2nd ed.), MIT Press and McGraw-Hill, pp. 168–170, ISBN 0-262-03293-7.</li>
            <li>http://http.developer.nvidia.com/GPUGems3/gpugems3_ch39.html</li>
          </ol>
        </div>
      </div>
    </div>
  </body>
</html>
